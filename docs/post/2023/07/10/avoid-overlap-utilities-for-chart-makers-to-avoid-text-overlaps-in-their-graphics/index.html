

  <!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>avoid-overlap: Utilities for chart-makers to avoid text overlaps in their graphics - Kevin Schaul</title>
    <meta property="og:title" content="avoid-overlap: Utilities for chart-makers to avoid text overlaps in their graphics - Kevin Schaul">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="I&amp;rsquo;ve been working on a library to help chart-makers avoid text overlaps in their graphics, and it&amp;rsquo;s finally in a place worth sharing. Check it out on GitHub or in action at two of my &amp;hellip;">
      <meta property="og:description" content="I&amp;rsquo;ve been working on a library to help chart-makers avoid text overlaps in their graphics, and it&amp;rsquo;s finally in a place worth sharing. Check it out on GitHub or in action at two of my &amp;hellip;">
      
    

    
    

    

    
    


    <style> @import url('https://fonts.googleapis.com/css2?family=Raleway:wght@300;500;800&display=swap'); </style>
    
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/custom.css" />

  </head>

  
  <body class="post">
    <header class="masthead">
      <h1><a href="/">Kevin Schaul</a></h1>

<p class="tagline">Visual journalist/hacker</p>

      <nav class="menu">
  <ul>
  
  
  <li><a href="/contact/">Contact</a></li>
  
  <li><a href="/link/">Worth your time</a></li>
  
  <li><a href="/til/">Today I learned</a></li>
  
  <li><a href="/index.xml">RSS</a></li>
<li style="display: none;"><a rel="me" href="https://tilde.zone/@kevinschaul">Mastodon</a></li>

  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>avoid-overlap: Utilities for chart-makers to avoid text overlaps in their graphics</h1>
<h3>July 10, 2023</h3>

      </header>

  
  
  
  
  <p>I&rsquo;ve been working on a library to help chart-makers avoid text overlaps in their graphics, and it&rsquo;s finally in a place worth sharing. Check it out <a href="https://github.com/kevinschaul/avoid-overlap">on GitHub</a> or in action at two of my <a href="https://www.washingtonpost.com/technology/interactive/2023/aging-america-retirees-workforce-economy/">recent</a> <a href="https://www.washingtonpost.com/technology/interactive/2023/ai-chatbot-learning/">graphics</a>.</p>
<p>Labeling charts, maps and other graphics is more art than science, but there are some general rules we can follow to achieve good results programmatically. This library provides two label-avoidance techniques: <code>nudge</code> and <code>choices</code>.</p>
<h3 id="nudge">Nudge</h3>
<p>The <code>nudge</code> technique resolves overlaps by simply nudging labels away from each other until they no longer collide. You can limit the nudging to specific directions and distances. This technique works well if the thing youâ€™re labeling is an area rather than a specific point.</p>
<p>The following images, from <a href="https://www.washingtonpost.com/technology/interactive/2023/ai-chatbot-learning/">a Washington Post graphic</a>, demonstrate the <code>nudge</code> technique. The labels were passed to <code>avoid-overlap</code>, specifying that nudging the labels either down or to the right would work.</p>
<table>
<thead>
<tr>
<th>Before</th>
<th>After</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="example-nudge-0.png" alt="Chart with labels overlapping"></td>
<td><img src="example-nudge-1.png" alt="Same chart with the overlapping labels nudged so they no longer collide"></td>
</tr>
</tbody>
</table>
<h3 id="choices">Choices</h3>
<p>The <code>choices</code> technique resolves overlaps by trying a series of positions provided by the user until it finds a combination that works. This technique works well if some number of different positions might work, for example if you are using a leader line or arrow.</p>
<p>In the following example, the labels were passed to <code>avoid-overlap</code> with a list of functions that could draw the label and an arrow in different positions: to the top left, top middle, top right, bottom left, bottom middle and bottom right. The library tries these positions until it finds a combination that works.</p>
<table>
<thead>
<tr>
<th>Before</th>
<th>After</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="example-choices-0.png" alt="Chart with labels overlapping"></td>
<td><img src="example-choices-1.png" alt="Same chart with the overlapping labels rendered using one of the provided choices so they no longer collide"></td>
</tr>
</tbody>
</table>
<h3 id="visual-testing">Visual testing</h3>
<p>This was my first time using visual testing in a project. I set it up using Storybook and Chromatic, and honestly it worked quite nicely. So far the tests are <a href="https://www.chromatic.com/build?appId=64a5bef463fbc133b9a4b6b6&amp;number=25">fairly simple</a>, but I&rsquo;m hoping this pays off in the future as I refine the overlap avoidance techniques.</p>
<p><a href="https://github.com/kevinschaul/avoid-overlap">See avoid-overlap on GitHub</a>.</p>

  
  
    <footer>
    
    <p>
      <i>
      Tags:
      
        <a href="https://www.kschaul.com/tags/d3/">d3</a>&nbsp;
      
        <a href="https://www.kschaul.com/tags/frontend/">frontend</a>&nbsp;
      
      </i>
    </p>
    

    
  
  

  </footer>
  </article>
  </body>
</html>

